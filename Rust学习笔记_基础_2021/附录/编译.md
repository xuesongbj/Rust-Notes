# 编译

直接使用 `rustc` 编译器，或使用 `cargo` 构建工具。

## rustc

编译器只接受 crate root 作为输入文件。

```rust
$ rustc [OPTIONS] INPUT
```

* `--crate-type`: 编译类型。(lib, bin)
* `--crate-name`: 
* `--edition`: 版本。 (2015, 2018)
* `-g`: 生成调试信息
* `-O`: `优化代码`。(`-C opt-level=2`)
* `-o`: 输出文件名。
* `-v`: 详细输出。

&nbsp;

> 优化等级:
>
> 0: 不优化
>
> 1: 基础优化
>
> 2: 标准优化
>
> 3: 深度优化(all)
>
> s: 优化尺寸(size)
>
> z: 优化尺寸，关闭循矢量化

&nbsp;

## cargo

整合工具链，可完成如下工作:

* 项目管理。
* 源码编译。
* 依赖管理。

```bash
$ cargo [+toolchain] [OPTIONS] [SUBCOMMAND]
```

* `new`: 创建新包
    
    * `--bin`: 使用 `binray` 模版。
    * `--lib`: 使用 `library` 模版。
    * `--name`: 包名。(默认使用目标名)

* `init`: 将现有目录初始化为包。

&nbsp;

* `check, c`: 分析并报告错误，不生成目标文件。
* `run, r`: 运行包

    * `--bin <name>`: 指定 bin 目标
    * `--package <spec>`: 指定 package 目标
    * `--release`: 发布版本

* `build, b`: 编译

    * `-v`: 输出 rustc详细信息。
    * `--workspace`: 编译工作空间下的所有包。
    * `--exclude <spec>`: 编译时忽略指定包。
    * `--lib`: 仅编译library。
    * `--bins`: 编译所有binary。
    * `--release`: 变异优化过的发布版本。

* `test, t`: 运行测试。
* `bench`: 运行性能测试。
* `clean`: 清除 target目录。
* `doc`: 生成包和依赖文档。

&nbsp;

* `update`: 更新依赖项
* `search`: 搜索包(crate.io)
* `publish`: 发布包(crate.io)

&nbsp;

* `--verbose, -v`: 输出详情编译参数信息。

&nbsp;

[Rustc Book](https://doc.rust-lang.org/rustc/index.html)

[Cargo Commands](https://doc.rust-lang.org/cargo/commands/index.html)

[Cargo Profiles](https://doc.rust-lang.org/cargo/reference/profiles.html)